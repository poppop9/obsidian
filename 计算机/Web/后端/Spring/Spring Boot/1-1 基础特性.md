
>[!quote] Spring
>Spring æ˜¯ä¸€ä¸ªå¼€å‘ç”Ÿæ€åœˆï¼Œå®ƒæä¾›äº†è‹¥å¹²ä¸ªå­é¡¹ç›®ï¼Œç”¨äºå®Œæˆç‰¹å®šåŠŸèƒ½
>![600](https://obsidian-1307744200.cos.ap-guangzhou.myqcloud.com/%E5%9B%BE%E7%89%87/202402291445627.png)

- **Spring**ï¼šä¹Ÿå°±æ˜¯ Spring Frameworkï¼ŒåŒ…å«äº†æ ¸å¿ƒåŠŸèƒ½ã€~~IOC~~ï¼Œ~~AOP~~ï¼Œ~~äº‹åŠ¡~~ â€¦â€¦ã€‘
- **SpringBoot**ï¼šåŸºäº Springï¼Œç®€åŒ–äº†å¼€å‘
- **Spring MVC**ï¼šæ˜¯ Spring ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œæä¾›äº†ä¸€ç§åŸºäº MVCã€æ¨¡å‹-è§†å›¾-æ§åˆ¶å™¨ã€‘è®¾è®¡æ¨¡å¼çš„æ¡†æ¶

![](https://obsidian-1307744200.cos.ap-guangzhou.myqcloud.com/%E5%9B%BE%E7%89%87/202402291447633.png)

- **SSM**ï¼šSpring , Spring MVC , MyBatis

---

```xml
<parent>
	<groupId>org.springframework.boot</groupId>
	<artifactId>spring-boot-starter-parent</artifactId>
	<version>3.2.0</version>
	<relativePath/> <!-- lookup parent from repository -->
</parent>

<dependencies>
	<dependency>  
	    <groupId>org.springframework.boot</groupId>  
	    <artifactId>spring-boot-starter-web</artifactId>  
	</dependency>  
	<dependency>  
	    <groupId>org.springframework.boot</groupId>  
	    <artifactId>spring-boot-starter-test</artifactId>  
	    <scope>test</scope>  
	</dependency>
</dependencies>
```

---

>[!quote] é¡¹ç›®ç»“æ„
> - `.mvn`Â Maven wrapper æ–‡ä»¶
> - `src`Â æºç ç›®å½•
>     - `main`
>         - `java`
>             - `åŒ…è·¯å¾„`
>                 - `å¯åŠ¨ç±»` 
>         - `resources`Â èµ„æºæ–‡ä»¶ç›®å½•
>             - `application.properties`Â SpringBoot é…ç½®æ–‡ä»¶
>     - `test`
>         - `java`
>             - `åŒ…è·¯å¾„`
> 			- `é¡¹ç›®åç§°ApplicationTests.java`Â æµ‹è¯• starters
> - `pom.xml`Â Mavené¡¹ç›®å¯¹è±¡æ¨¡å‹é…ç½®æ–‡ä»¶

# è¯·æ±‚
- `RequestMapping` çš„å­é›†ï¼š
	- `@GetMapping`  é™å®šè·¯å¾„çš„è¯·æ±‚æ–¹å¼åªèƒ½æ˜¯ HTTP GET
	- `@PostMapping`  é™å®šè·¯å¾„çš„è¯·æ±‚æ–¹å¼åªèƒ½æ˜¯ HTTP POST
	- `@PutMapping` é™å®šè·¯å¾„çš„è¯·æ±‚æ–¹å¼åªèƒ½æ˜¯ HTTP PUT
	- `@DeleteMapping`  é™å®šè·¯å¾„çš„è¯·æ±‚æ–¹å¼åªèƒ½æ˜¯ HTTP DELETE
	- â€¦â€¦

## ç®€å•å‚æ•° / è¡¨å•å‚æ•°
GET è¯·æ±‚ï¼š`http://localhost:8080/simpleParam?name=Tom&age=10`
```java
@RestController
public class RequestController {  
	// æ³¨é‡ŠRequestMappingï¼Œå®šä¹‰è¯·æ±‚è·¯å¾„
    @RequestMapping("/simpleParam")    
    public String simpleParam(String name, Integer age) {  
        System.out.println(name + ":" + age);  
        return "OK";  
    }  
}


Tom:10
```

**@RestController = @Controller + @ResponseBody**ã€æ–¹æ³•çš„è¿”å›å€¼å°†ç›´æ¥ä½œä¸ºè¯·æ±‚ä½“è¿”å›ã€‘

## å¤æ‚å‚æ•°
GET è¯·æ±‚ï¼š`http://localhost:8080/complexPojo?name=Tom&age=20&address.province=å¹¿ä¸œ&address.city=å¹¿å·`
```java
@RequestMapping("/complexPojo")  
public String complexPojo(User user) {  
    System.out.println(user);  
    return "OK";  
}


User{name='Tom', age=20, address=Address{province='å¹¿ä¸œ', city='å¹¿å·'}}
```

```java
public class User {  
    private String name;  
    Integer age;  
    Address address;  

	getï¼Œsetæ–¹æ³•
	toStringæ–¹æ³•
}
```

```java
public class Address {  
    String province;  
    String city;  
  
    public String getProvince() {  return province;  }  
  
    public void setProvince(String province) {  this.province = province;  }  
  
    public String getCity() {  return city;  }  
  
    public void setCity(String city) {  this.city = city;  }  
  
    @Override  
    public String toString() {  
        return "Address{" +  
                "province='" + province + '\'' +  
                ", city='" + city + '\'' +  
                '}';  
    }  
}
```

## æ•°ç»„å‚æ•°
GET è¯·æ±‚ï¼š`http://localhost:8080/arrayParam?hobby=dance&hobby=game&hobby=sing`
```java
@RequestMapping("/arrayParam")  
public String ArrayParam(String[] hobby) {    //æ•°ç»„åä¸è¯·æ±‚å‚æ•°åç›¸åŒ
    System.out.println(Arrays.toString(hobby));  
    return "OK";  
}


[dance, game, sing]
```

## é›†åˆå‚æ•°
GET è¯·æ±‚ï¼š`http://localhost:8080/listParam?hobby=dance&hobby=game&hobby=sing` 
```java
@RequestMapping("/listParam")  
public String ListParam(@RequestParam List<String> hobby) {
    System.out.println(hobby);  
    return "OK";  
}


[dance, game, sing]
```

## åŠ¨æ€å‚æ•°
å‰ç«¯ä¼ çš„å‚æ•°æ•°é‡å¯èƒ½æ˜¯ä¸å›ºå®šçš„ï¼Œè¿™æ—¶æˆ‘ä»¬éœ€è¦ä½¿ç”¨ Map é›†åˆæ¥åŠ¨æ€æ¥æ”¶

```java
@PatchMapping("/update")
public Response updateCostItem(@RequestParam Map<String, String> allParams) {
    Response response = new Response();
    Service.update(allParams);
    return response;
}
```

## æ—¥æœŸå‚æ•°
GET è¯·æ±‚ï¼š`http://localhost:8080/dateParam?updateTime=2023-10-09 15:50:20`
```java
@RequestMapping("/dateParam")  
public String DateParam(@DateTimeFormat(pattern = "yyyy-MM-dd HH:mm:ss") LocalDateTime updateTime) {  
    System.out.println(updateTime);  
    return "OK";  
}


2023-10-09T15:50:20
```

## Json å‚æ•°
POST è¯·æ±‚ï¼š`http://localhost:8080/jsonParam`
```json
{
Â  Â  "name": "Tom",
Â  Â  "age": 20,
Â  Â  "address": {
Â  Â  Â  Â  "province": "å¹¿ä¸œ",
Â  Â  Â  Â  "city": "å¹¿å·"
Â  Â  }
}
```

```java
@RequestMapping("/jsonParam")  
public String JsonParam(@RequestBody User user) {  //æ³¨è§£è¡¨ç¤ºå°†jsonæ•°æ®å°è£…æˆå¯¹è±¡
    System.out.println(user);  
    return "OK";  
}


User{name='Tom', age=20, address=Address{province='å¹¿ä¸œ', city='å¹¿å·'}}
```

## è·¯å¾„å‚æ•°
GET è¯·æ±‚ï¼š`http://localhost:8080/users/1/posts/2`
```java
@RequestMapping("/users/{userId}/posts/{postId}")  
public String PathParam(@PathVariable Integer userId, @PathVariable Integer postId) {
	System.out.println("User ID: " + userId);
	System.out.println("Post ID: " + postId);
    return "OK";  
}

---
123
```

## æ–‡ä»¶å‚æ•°
`MultipartFile` **æ˜¯ SpringBoot æä¾›çš„ä¿å­˜æ–‡ä»¶çš„ä¸€ç§æ ¼å¼**

>[!summary] æ–¹æ³•
> - `getName()`  è¿”å›å‰ç«¯formè¡¨å•çš„åç§°
> - `getOriginalFilename()`  è·å–æºæ–‡ä»¶çš„æ˜µç§°
> - `getContentType()`  è¿”å›æ–‡ä»¶çš„å†…å®¹ç±»å‹
> - `isEmpty()`  åˆ¤æ–­ä¸Šä¼ çš„æ–‡ä»¶æ˜¯å¦æœ‰å†…å®¹
> - `getSize()`  è¿”å›æ–‡ä»¶å¤§å°ã€å•ä½ä¸ºå­—èŠ‚ã€‘
> - `getBytes()`  è¿”å›ä¸€ä¸ªå°†æ–‡ä»¶å†…å®¹è½¬åŒ–æˆä¸€ä¸ªä»¥byteä¸ºå…ƒç´ çš„æ•°ç»„
> - `getInputStream()`  è¿”å›InputStreamè¯»å–æ–‡ä»¶çš„å†…å®¹
> - `transferTo(File var1)`  å¤åˆ¶fileæ–‡ä»¶åˆ°æŒ‡å®šä½ç½®

- å‰ç«¯
```html
<form action="/upload" method="get" enctype="multipart/form-data">
	å›¾åƒ: <input type="file" name="image">
</form>
```

- åç«¯
```Properties
#åœ¨é…ç½®æ–‡ä»¶ä¸­é™åˆ¶ä¸Šä¼ æ–‡ä»¶çš„Size

#é…ç½®å•ä¸ªæ–‡ä»¶ä¸Šä¼ å¤§å°é™åˆ¶ï¼ˆé»˜è®¤å€¼ä¸º1Mï¼‰  
spring.servlet.multipart.max-file-size=10MB  
#é…ç½®å•æ¬¡è¯·æ±‚ä¸Šä¼ æ–‡ä»¶æ€»å¤§å°é™åˆ¶ï¼ˆé»˜è®¤å€¼ä¸º10Mï¼‰  
spring.servlet.multipart.max-request-size=100MB
```

```java
@RestController  
public class UploadController {  
    @PostMapping("/upload")  
    public Result UploadFile(MultipartFile image) throws IOException {  
	    //è·å–åˆ°imageå¯¹è±¡çš„æ–‡ä»¶å
        String originalFilename = image.getOriginalFilename();  
        //æ‹¿åˆ°æ–‡ä»¶åçš„æœ€åä¸€ä¸ª.çš„ç´¢å¼•
        int indexOf = originalFilename.lastIndexOf(".");  
        //è·å–åˆ°è¯¥æ–‡ä»¶çš„åç¼€å
        String suffixName = originalFilename.substring(indexOf);  

		//è·å–uuid
        String uuid = UUID.randomUUID().toString();  
        //æ‹¼æ¥uuidå’Œåç¼€å
        String newFileName = uuid + suffixName;  

		//å°†æ–‡ä»¶ä¿å­˜åˆ°æŒ‡å®šè·¯å¾„
        image.transferTo(new File("E:/æŠ–éŸ³/" + newFileName));  
  
        return Result.buildResult(Result.Status.OK);  
    }  
}
```

>[!hint] æ–‡ä»¶é€šè¿‡MultipartFileä¼ é€’åˆ°æœåŠ¡å™¨åï¼Œä¼šäº§ç”Ÿä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œå¦‚æœè¿™æ—¶ä¸å¯¹æ–‡ä»¶åšä»»ä½•æ“ä½œã€‚åªè¦è¯·æ±‚å“åº”å®Œæ¯•ä¹‹åï¼Œ**è¿™ä¸ªæ–‡ä»¶å°±ä¼šè¢«è‡ªåŠ¨åˆ é™¤ï¼Œä¸ä¼šä¿å­˜**

## ğŸ’› æ³¨è§£
###  @RequestParam
- `required` è®¾ç½®è¯¥å‚æ•°æ˜¯å¦å¿…ä¼ 
	- true å‚æ•°å¿…é¡»è¦ä¼ ï¼Œä¸ä¼ æŠ›å¼‚å¸¸
	- false å‚æ•°å¯ä»¥ä¸ä¼ ï¼Œä¸ä¼ ä¸º null
- `defaultValue` ç»™å‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œ<u>åªæ”¯æŒå•ä¸ªå‚æ•°ï¼Œä¸æ”¯æŒç»™é›†åˆè®¾ç½®</u>
- `name` å½“ä¼ å‚åå’Œæ¥æ”¶å‚æ•°åä¸ä¸€è‡´æ—¶ï¼Œè¿›è¡Œæ˜ å°„

```java
@GetMapping("/greet")
public String greet(@RequestParam(required = false) String name) {
    if (name == null) {
        return "Hello, Guest!";
    }
    return "Hello, " + name + "!";
}
```

```java
@GetMapping("/greet")
public String greet(@RequestParam(defaultValue = "Guest") String name) {
    return "Hello, " + name + "!";
}
```

```java
/greet?username=John

@GetMapping("/greet")
public String greet(@RequestParam(name = "username") String name) {
    return "Hello, " + name + "!";
}
```

>[!hint] ä½¿ç”¨æŠ€å·§
>- ä¼ å…¥ç®€å•å‚æ•° / è¡¨å•å‚æ•°æ—¶ï¼Œä¸€èˆ¬ä¸éœ€è¦ä½¿ç”¨ `@RequestParam` ï¼Œä½†æ˜¯å‰ç«¯è¯·æ±‚æ—¶ä¸ä¼ å‚æ•°ä¸ä¼šæŠ¥æ˜æ˜¾é”™è¯¯ï¼Œè¿™æ ·ä¸å¥½
>	- å½“ä½ çš„ä¼ å‚åï¼Œå’Œæ¥æ”¶åä¸åŒæ—¶ï¼Œéœ€è¦ä½¿ç”¨è¯¥æ³¨è§£æ¥åè°ƒ
>	- å½“ä½ éœ€è¦è®¾ç½®è¯¥å‚æ•°æ˜¯å¦å¿…ä¼ æ—¶ï¼Œéœ€è¦ä½¿ç”¨è¯¥æ³¨è§£
>	- å½“éœ€è¦ç»™å‚æ•°è®¾ç½®é»˜è®¤å€¼æ—¶
>- ä¼ å…¥é›†åˆå‚æ•° / åŠ¨æ€å‚æ•°æ—¶ï¼Œéœ€è¦ä½¿ç”¨è¯¥æ³¨è§£

# å“åº”
## åº”ç”¨çº§åˆ«å“åº”
>[!quote]+ åº”ç”¨çº§åˆ«å“åº” æŒ‡çš„æ˜¯å³ä½¿è®¾ç½®äº† 4xxï¼Œä½†æ˜¯ç”¨æˆ·è¯·æ±‚æ—¶éƒ½æ˜¯ 2xxï¼Œåªæ˜¯åœ¨ HTTP å“åº”ä½“ä¸­å¯èƒ½ä¼šå‡ºç° 4xxï¼Œä¸€èˆ¬ç”¨è‡ªå®šä¹‰çš„ Result ç±»æ¥å®ç°
> ```java
> public class Result\<T> {   
>     private String status;      //çŠ¶æ€ç  
>   
>     public String getStatus() {      //è·å–çŠ¶æ€  
>         return status;  
>     }  
>    
>     private String message;      //çŠ¶æ€ä¿¡æ¯,é”™è¯¯æè¿° 
>     
>     public String getMessage() {  //è·å–æ¶ˆæ¯å†…å®¹
>         return message;  
>     }  
>    
>     private T data;      //æ•°æ® 
>    
>     public T getData() {  //è·å–æ•°æ®å†…å®¹
>         return data;  
>     }  
>   
>     private Result(String status, String message, T data) {  
>         this.status = status;  
>         this.message = message;  
>         this.data = data;  
>     }  
>   
>     private Result(String status, String message) {  
>         this.status = status;  
>         this.message = message;  
>     }  
>   
>     private Result(String message) {  
>         this.message = message;  
>     }  
>   
>     //åˆ›å»ºä¸€ä¸ªå¸¦æœ‰çŠ¶æ€ã€æ¶ˆæ¯å’Œæ•°æ®çš„ç»“æœå¯¹è±¡ 
>     public static \<T> Result\<T> buildResult(Status status, String message, T data) {  
>         return new Result\<T>(status.getCode(), message, data);  
>     }  
>   
>     //åˆ›å»ºä¸€ä¸ªå¸¦æœ‰çŠ¶æ€ã€æ¶ˆæ¯å’Œæ•°æ®çš„ç»“æœå¯¹è±¡
>     public static \<T> Result\<T> buildResult(Status status, String message) {  
>         return new Result\<T>(status.getCode(), message);  
>     }  
>   
>     // åˆ›å»ºä¸€ä¸ªå¸¦æœ‰çŠ¶æ€å’Œæ•°æ®çš„ç»“æœå¯¹è±¡
>     public static \<T> Result\<T> buildResult(Status status, T data) {  
>         return new Result\<T>(status.getCode(), status.getReason(), data);  
>     }  
>   
>     public static \<T> Result\<T> buildResult(Status status) {  
>         return new Result\<T>(status.getCode(), status.getReason());  
>     }  
>   
>     public enum Status {  
>         OK("200", "æ­£ç¡®"),  
>         BAD_REQUEST("400", "é”™è¯¯çš„è¯·æ±‚"),  
>         UNAUTHORIZED("401", "ç¦æ­¢è®¿é—®"),  
>         NOT_FOUND("404", "æ²¡æœ‰å¯ç”¨çš„æ•°æ®"),  
>         PWD_ERROR("300", "å¯†ç é”™è¯¯"),  
>         EXIT("403", "å·²ç»å­˜åœ¨"),  
>         INTERNAL_SERVER_ERROR("500", "æœåŠ¡å™¨é‡åˆ°äº†ä¸€ä¸ªæœªæ›¾é¢„æ–™çš„çŠ¶å†µ"),  
>         SERVICE_UNAVAILABLE("503", "æœåŠ¡å™¨å½“å‰æ— æ³•å¤„ç†è¯·æ±‚"),  
>         ERROR("9999", "æ•°æ®ä¸èƒ½ä¸ºç©º");  
>   
>         // çŠ¶æ€ç ,é•¿åº¦å›ºå®šä¸º6ä½çš„å­—ç¬¦ä¸².  
>         private String code;  
>   
>         // é”™è¯¯ä¿¡æ¯  
>         private String reason;  
>   
>         Status(String code, String reason) {  
>             this.code = code;  
>             this.reason = reason;  
>         }  
>   
>         public String getCode() {  
>             return code;  
>         }  
>   
>         public String getReason() {  
>             return reason;  
>         }  
>   
>         @Override  
>         public String toString() {  
>             return code + ": " + reason;  
>         }  
>     }  
> }
> ```

- **å“åº”å¯¹è±¡**
```java
@RequestMapping("/address")  
public Result<Address> address() {  
    Address address = new Address();  
    address.setProvince("å¹¿ä¸œ");  
    address.setCity("å¹¿å·");  
    return Result.buildResult(Result.Status.OK, address);  //ä¼ é€’çŠ¶æ€ç ï¼Œæ•°æ®
}

---
{
    "status": "200",
    "message": "æ­£ç¡®",
    "data": {
        "province": "å¹¿ä¸œ",
        "city": "å¹¿å·"
    }
}
```

- **å“åº”é›†åˆ**
```java
@RequestMapping("/list")  
public Result<List<Address>> list() {  
    List<Address> list = new ArrayList<>();  
    Address add1 = new Address();  
    add1.setProvince("å¹¿ä¸œ");  
    add1.setCity("å¹¿å·");  
  
    Address add2 = new Address();  
    add2.setProvince("ç¦å»º");  
    add2.setCity("å¦é—¨");  
  
    list.add(add1);  
    list.add(add2);  
  
    return Result.buildResult(Result.Status.OK, list);  
}

---
{
    "status": "200",
    "message": "æ­£ç¡®",
    "data": [
        {
            "province": "å¹¿ä¸œ",
            "city": "å¹¿å·"
        },
        {
            "province": "ç¦å»º",
            "city": "å¦é—¨"
        }
    ]
}
```

## éåº”ç”¨çº§åˆ«å“åº”
>[!quote] éåº”ç”¨çº§åˆ«å“åº”
>éåº”ç”¨çº§åˆ«å“åº” ç›´æ¥ä¼šå“åº”åˆ° HTTP çŠ¶æ€ç é‡Œï¼Œè®¾ç½®ä¸º 4xx æ—¶ï¼Œè¯·æ±‚å°±ä¼šå¤±è´¥

```java
import org.springframework.http.ResponseEntity;

@GetMapping("/verify")
public ResponseEntity<String> verify(String token) {
	if (token.equals("success")) {
		return ResponseEntity.ok("success");
	} else {
		return ResponseEntity.status(HttpStatus.OK).body("forbidden");
	}
}
```


# åˆ†å±‚
## Dao
>Dao å±‚çš„ä½œç”¨æ˜¯è·å–æ•°æ®ã€æ–‡ä»¶æ•°æ®ï¼Œxml æ•°æ®ï¼Œjson æ•°æ®ç­‰ã€‘ï¼Œ<u>åœ¨ MyBatis ä¸­å« Mapper</u>

```java
package com.example.web_2.Dao;  
  
public interface EmpDao {  //å®šä¹‰ä¸€ä¸ªæ¥å£ï¼Œå›ºå®šæ ¼å¼
    public List<String> listEmp();  
}
```

```java
package com.example.web_2.Dao;  

//åŠ è½½æ•°æ®ã€æ–‡ä»¶æ•°æ®ï¼Œxmlæ•°æ®ï¼Œjsonæ•°æ®ç­‰ã€‘
public class EmpDaoA implements EmpDao {    
    @Override  
    public List<String> listEmp() {  
        List<String> list1 = new ArrayList(List.of("å´å½¦ç¥–", "é™ˆå† å¸Œ", "é‡‘åŸæ­¦"));  
        return list1;  
    }  
}
```

## Service
>Sevice å±‚çš„ä½œç”¨å¯¹æ•°æ®è¿›è¡Œå¤„ç†ï¼Œç„¶åè¿”å›ç»™ Controller ç±»

```java
package com.example.web_2.Service;  

public interface EmpServie {  
    public List<String> listEmp();  
}
```

```java
package com.example.web_2.Service;  
  
//å¯¹æ•°æ®è¿›è¡Œé€»è¾‘å¤„ç†ï¼Œè¿”å›ç»™Controllerç±»  
public class EmpServiceA implements EmpServie {  
    private EmpDao empDao = new EmpDaoA();  //éœ€è¦ä»EmpDaoè·å–æ•°æ®ï¼Œæ‰€ä»¥åˆ›å»ºæ¥å£å¯¹è±¡

    @Override  
    public List<String> listEmp() {  
        List<String> emplist = empDao.listEmp();  
        emplist.add("é»æ˜");  //å¯¹æ•°æ®è¿›è¡Œå¤„ç†ã€æ·»åŠ æ•°æ®ã€‘
        return emplist;  
    }  
}

/*
ä½¿ç”¨private EmpDao empDao = new EmpDaoA();çš„æ–¹å¼æ˜¯ä¸ºäº†éµå¾ªç¼–ç¨‹ä¸­çš„"é¢å‘æ¥å£ç¼–ç¨‹"åŸåˆ™ï¼Œè¿™æ ·å¯ä»¥åœ¨éœ€è¦æ—¶è½»æ¾æ›¿æ¢å…·ä½“çš„å®ç°ç±»ï¼Œè€Œæ— éœ€ä¿®æ”¹EmpServiceAç±»çš„å…¶ä»–éƒ¨åˆ†ã€‚è¿™æ ·ï¼Œä»£ç åœ¨å¤„ç†empDaoæ—¶åªå…³æ³¨EmpDaoæ¥å£å®šä¹‰çš„æ–¹æ³•ï¼Œè€Œä¸ä¾èµ–äºå…·ä½“çš„å®ç°ç»†èŠ‚ã€‚

å¦å¤–ï¼Œé€šè¿‡ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„è®¾è®¡æ¨¡å¼ï¼Œå¯ä»¥å°†EmpDaoå¯¹è±¡çš„åˆ›å»ºå’Œç®¡ç†äº¤ç»™å¤–éƒ¨çš„ä»£ç ï¼ˆä¾‹å¦‚ä½¿ç”¨ä¾èµ–æ³¨å…¥å®¹å™¨æˆ–æ‰‹åŠ¨æ³¨å…¥ï¼‰ã€‚è¿™æ ·å¯ä»¥æ›´å¥½åœ°è§£è€¦å’Œç»„ç»‡ä»£ç ï¼Œæé«˜ä»£ç çš„å¯æµ‹è¯•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚
*/
```

## Controller
>Controller çš„ä½œç”¨æ˜¯è·å–æ¥è‡ª Service ç±»å‘æ¥çš„æ•°æ®ï¼Œå“åº”æ•°æ®ç»™å‰ç«¯

```java
package com.example.web_2.Controller;  

//è·å–Serviceå‘æ¥çš„æ•°æ®ï¼Œå¹¶å“åº”æ•°æ®ç»™å‰ç«¯  
@RestController  
public class EmpController {  
    private EmpServie empServie = new EmpServiceA();  //åˆ›å»ºEmpServiceå¯¹è±¡
  
    @RequestMapping("/emp")  
    public Result listEmp() {  
        List<String> list = empServie.listEmp();  //è·å–Serviceå¤„ç†è¿‡åçš„æ•°æ®
        return Result.buildResult(Result.Status.OK, list);  //è¿”å›æ•°æ®
    }  
}


---
GETè¯·æ±‚ï¼š`http://localhost:8080/emp`
jsonï¼š
{
    "status": "200",
    "message": "æ­£ç¡®",
    "data": [
        "å´å½¦ç¥–",
        "é™ˆå† å¸Œ",
        "é‡‘åŸæ­¦",
        "é»æ˜"
    ]
}
```

### å…¬å…±è·¯å¾„
>åœ¨ç±»çš„å¤´éƒ¨æŒ‡å®š `@RequestMapping` æ³¨è§£

```java
@RestController  
@RequestMapping("/user")             //æŒ‡å®šå…¬å…±è·¯å¾„
public class UserController {  
    @Autowired  
    private UserService us;  

    @PostMapping                   //è¡¨ç¤ºè·¯å¾„ä¸ºPOSTè¯·æ±‚çš„/user
    public Result InsertUser(@RequestBody user user) {  
        us.InsertUser(user);  
        return Result.buildResult(Result.Status.OK);  
    }  
    
    @GetMapping("/1")              //è¡¨ç¤ºè·¯å¾„ä¸ºGetè¯·æ±‚çš„/user/1
    public List<user> SelectUser(Integer id) {  
	    return â€¦â€¦
    }  
}
```

# è§£è€¦
>ä»¥ä¸Šçš„åˆ†å±‚æ–¹å¼ï¼Œå®ç°äº†**é«˜å†…èš**ï¼Œä½†æ˜¯ä¾ç„¶æ²¡æœ‰å®ç°**ä½è€¦åˆ**ã€Controller ä¸­è¿˜æ˜¯æœ‰ä¾èµ– Serviceï¼ŒService è¿˜æ˜¯æœ‰ä¾èµ– Daoã€‘
>![[Excalidraw/è®¡ç®—æœº/JavaWeb Draw.md#^group=g1pvEhriTd5poW0zM1k4o|500]]
>EmpController éœ€è¦ EmpServiceï¼Œé‚£æˆ‘ä»¬å¯ä»¥æŠŠ EmpService æ”¾åˆ° IOC å®¹å™¨é‡Œï¼Œç„¶å EmpController éœ€è¦æ—¶å°±åˆ°å®¹å™¨ä¸­å–

## æ§åˆ¶åè½¬ IOC
>å¯¹è±¡çš„åˆ›å»ºæ§åˆ¶æƒç”±ç¨‹åºè‡ªèº«è½¬ç§»åˆ°å®¹å™¨ã€~~æœ¬èº«ç”± EmpController è‡ªèº«åˆ›å»ºEmpService å¯¹è±¡ï¼Œå˜ä¸ºç”±å®¹å™¨åˆ›å»ºå¯¹è±¡~~ã€‘

>[!hint] å¯¹è±¡åœ¨ IOC å®¹å™¨ä¸­å« Bean å¯¹è±¡ï¼ŒBean å¯¹è±¡çš„åç§°é»˜è®¤æ˜¯**ç±»åé¦–å­—æ¯å°å†™**

-  `@Component` å¦‚æœæŸä¸ªç±»ä¸å±äºä»¥ä¸‹ä¸‰ç±»ï¼Œä½†æ˜¯ä¹Ÿæƒ³äº¤ç»™ IOC å¤„ç†æ—¶
	- å¦‚æœæ˜¯æ§åˆ¶å™¨ç±»ä¸Šå°±ç”¨ `@Controller`
	- å¦‚æœæ˜¯é€»è¾‘å¤„ç† Service å®ç°ç±»å°±ç”¨ `@Service`
	- å¦‚æœæ˜¯è®¿é—® Dao ç±»ä¸Šå°±ç”¨ `@Repository`ã€å¦‚æœ Dao å±‚ä¸­éœ€è¦ä½¿ç”¨MyBatisï¼Œé‚£è¦å°† `@Repository` æ³¨è§£æ”¹ä¸º `@Mapper` ã€‘

## ä¾èµ–æ³¨å…¥ DI
>å®¹å™¨ä¸ºåº”ç”¨ç¨‹åºæä¾›è¿è¡Œæ—¶æ‰€ä¾èµ–çš„èµ„æºã€~~ä¾‹å¦‚ï¼Œå®¹å™¨ä¸º EmpController æä¾›è¿è¡Œæ—¶æ‰€éœ€è¦çš„ EmpService å¯¹è±¡~~ã€‘

- æ·»åŠ  `@Autowired` æ³¨é‡Šã€é€šè¿‡ç±»å‹æ³¨å…¥<u>å•ä¸ªæ³¨è§£ä¸­çš„å•ä¸ªä¾èµ–</u>ã€‘
- æ·»åŠ  `@Primary` æ³¨é‡Šã€é€šè¿‡ç±»å‹æ³¨å…¥<u>å¤šä¸ªæ³¨è§£ä¸­çš„å•ä¸ªä¾èµ–</u>ã€‘
```java
package com.example.web_2.Service;  
  
@Service
public class EmpServiceA implements EmpServie {â€¦â€¦}
```

```java
package com.example.web_2.Service;  
  
@Primary  //è¡¨ç¤ºä¼˜å…ˆè¿™ä¸ªServiceç±»
@Service  
public class EmpServiceB implements EmpServie {â€¦â€¦}
```

- æ·»åŠ  `@Qualifier` æ³¨é‡Šã€é€šè¿‡ç±»å‹æ³¨å…¥<u>å¤šä¸ªæ³¨è§£ä¸­çš„å•ä¸ªä¾èµ–</u>ã€‘
```java
package com.example.web_2.Controller;  

@RestController  
public class EmpConteoller {  
	@Qualifier("empServiceB")  //æŒ‡å®šä½¿ç”¨çš„Beanå¯¹è±¡çš„åç§°ã€é»˜è®¤ä¸ºç±»åé¦–å­—æ¯å°å†™ã€‘
	@Autowired  
	private EmpServie empServie;  
  
	@RequestMapping("/emp")  
	public Result listEmp() {  
		List<String> list = empServie.listEmp();  
		return Result.buildResult(Result.Status.OK, list);  
	}  
}
```

- æ·»åŠ  `@Resource` æ³¨é‡Šã€é€šè¿‡åç§°æ³¨å…¥ä¾èµ–ã€‘
```java
package com.example.web_2.Controller;  

@RestController  
public class EmpConteoller {  
	@Resource(name = "empServiceB")  //ç›´æ¥æŒ‡å®šBeançš„åç§°
	private EmpServie empServie;  
  
	@RequestMapping("/emp")  
	public Result listEmp() {  
		List<String> list = empServie.listEmp();  
		return Result.buildResult(Result.Status.OK, list);  
	}  
}
```

---

```java
@Repository  //å°†è¿™ä¸ªç±»äº¤ç»™IOCå®¹å™¨å¤„ç†ï¼Œæˆä¸ºIOCå®¹å™¨ä¸­çš„Bean
public class EmpDaoA implements EmpDao {  
    //åŠ è½½æ•°æ®ã€æ–‡ä»¶æ•°æ®ï¼Œxmlæ•°æ®ï¼Œjsonæ•°æ®ç­‰ã€‘  
    @Override  
    public List<String> listEmp() {  
        List<String> list1 = new ArrayList(List.of("å´å½¦ç¥–", "é™ˆå† å¸Œ", "é‡‘åŸæ­¦"));  
        return list1;  
    }  
}
```

```java
package com.example.web_2.Service;  

@Service //å°†è¿™ä¸ªç±»äº¤ç»™IOCå®¹å™¨å¤„ç†ï¼Œæˆä¸ºIOCå®¹å™¨ä¸­çš„Bean  
public class EmpServiceA implements EmpServie {  
    @Autowired  //ç¨‹åºè¿è¡Œæ—¶ï¼ŒIOCå®¹å™¨ä¼šä¸ºè¿™ä¸ªå˜é‡æä¾›Beanå¯¹è±¡  
    private EmpDao empDao;  
  
    @Override  
    public List<String> listEmp() {  
        List<String> emplist = empDao.listEmp();  
        emplist.add("é»æ˜");  
        return emplist;  
    }  
}
```

```java
@RestController  
public class EmpController {  
    @Autowired  //ç¨‹åºè¿è¡Œæ—¶ï¼ŒIOCå®¹å™¨ä¼šä¸ºè¿™ä¸ªå˜é‡æä¾›Beanå¯¹è±¡
    private EmpServie empServie;  
  
    @RequestMapping("/emp")  
    public Result listEmp() {  
        List<String> list = empServie.listEmp();  
        return Result.buildResult(Result.Status.OK, list);  
    }  
}
```


