# 数据库的优化
## 索引
>索引是***高效获取数据***的数据结构。MYSQL中的索引有多种，默认是B+Tree索引

- 索引可以提高搜索的效率
- 索引会占用存储空间
- ***索引降低了***`INSERT`，`UPDATE`，`DELETE`***的效率***【因为修改数据时需要重新维护数据结构】

>[!hint] 当我为一张表创建***主键***后，MYSQL会自动帮我们为主键字段创建一个***主键索引***[^4]

>[!hint] 当我为一张表创建***唯一约束***后，MYSQL会自动帮我们为该字段创建一个***唯一索引***
### 创建索引
```sql
CREATE [UNIQUE] INDEX 索引名 ON 表名(字段名);

---

CREATE INDEX idx_emp_name ON emp(name);
```
### 查看索引
```sql
SHOW INDEX FROM 表名;
```
### 删除索引
```sql
DROP INDEX 索引名 ON 表名;
```

[^4]:主键索引是所有索引中性能最高的

# 问题处理
>[!faq] 如果要为表的主键添加auto increment属性，这个表的主键被作为了其他表的外键，每个表中都有数据，我不想数据丢失，那我该怎么办？

- 在表中添加一个新的自增长主键列，而不删除现有的主键列
	```
	ALTER TABLE customer ADD COLUMN NewID INT AUTO_INCREMENT PRIMARY KEY FIRST;
	```
- 将现有的主键列的值复制到新的主键列中
	```sql
	UPDATE customer SET NewID = CustomerID;
	```
- 对于引用了表主键的其他表，更新它们的外键引用，将其指向新的主键列 "NewID"
	```sql
	ALTER TABLE other_table ADD CONSTRAINT fk_customer_id FOREIGN KEY (customer_id) REFERENCES customer (NewID);
	```
- 删除旧的主键列
	```sql
	ALTER TABLE customer DROP COLUMN CustomerID;
	```
- 最后将“NewID”设置为主键
