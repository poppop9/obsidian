# 变量
>[!hint] 变量
>- 与其他编程语言相同，有类型，有作用域，可以给变量赋值
>- 变量名只能是英文字母、数字或者下划线，且不能以数字作为开头

- 创建变量 `declare 变量名`
- 给变量赋值 `tmp=shiyanlou` 
- 读取变量 `echo $变量名` 【~~`$` 表示引用一个变量的值~~】

```bash
$ declare testname                             
$ testname=ttt111                                                       
$ echo $testname                                           
ttt111
```

## 环境变量
> 环境变量 是特殊的变量，它不仅在当前 shell 中可用，<u>也可以被子 shell，或者程序访问</u>

>[!hint] 为了与普通变量区分，通常我们习惯将环境变量名**大写**

- 每个进程都有其各自的环境变量设置
- 默认情况下，当一个进程被创建时，它将继承其父进程的绝大部分环境设置【~~如果不在创建过程中明确指定的话~~】
- 某个进程的环境变量作用于自身和它的子进程

>[!hint] Shell 程序也作为一个进程运行在操作系统之上，而我们在 Shell 中运行的大部分命令都将以 Shell 的子进程的方式运行

### 变量类型
- 当前 Shell 进程<u>私有用户自定义变量</u>【自己使用 `declare` 创建的变量，只在当前 Shell 中有效】
- Shell 本身内建的变量
- 从自定义变量导出的环境变量


### 打印环境变量
![300](https://obsidian-1307744200.cos.ap-guangzhou.myqcloud.com/%E5%9B%BE%E7%89%87/202403271030969.png)

- `set`：显示当前 Shell 所有变量，包括其内建环境变量【与 Shell 外观等相关】，用户自定义变量，导出的环境变量
- `env`：显示与当前用户相关的环境变量，还可以让命令在指定环境中运行
- `export`：显示从 Shell 中导出成环境变量的变量，也能通过它将自定义变量导出为环境变量

---

>[!hint] 如何区分 变量 与 环境变量 ？
>>某个变量在当前进程的子进程有效则为环境变量
>
> ```bash
> # 将普通变量转为环境变量
> $ temp1=aaa                                                                       
> $ echo $temp1                                                                
> aaa
> 
> # 创建子 shell
> $ zsh             
> # 打印出来值为空
> $ echo $temp1                                                               
> 
> # 退出子 shell
> $ exit                                                                               
> $ echo $temp1                                                                 
> aaa
> 
> # 导出temp1为环境变量
> $ export temp1                                                                      
> $ zsh                                                                                     
> $ echo $temp1                                                                             
> aaa
> ```

### 变量的生存周期
- 永久的：需要修改配置文件，变量永久生效 
- 临时的：使用 export 命令行声明，变量在关闭 shell 时失效

---
- 存放变量的文件
	- `/etc/bashrc` 存放 shell 变量
	- `/etc/profile` 存放对所有用户永久生效的环境变量
	- `/home/用户/.profile` 存放对当前用户永久生效的环境变量

# PATH
> `PATH` 是一个特殊的环境变量，当我们在 Shell 中执行一个命令时，系统就会按照 `PATH` 中设定的路径按照顺序依次到目录中去查找【如果存在同名的命令，则执行先找到的那个】

>[!hint] 查看 `PATH` 环境变量中的内容，`echo $PATH`

---

- 创建一个 C 语言 `hello world` 程序
```bash
cd /home/shiyanlou
vim hello_world.c

# 添加内容-------------------
#include <stdio.h>

int main(void)
{
    printf("hello world!\n");
    return 0;
}

# 使用 gcc 生成可执行文件【具有可执行权限】
gcc -o hello_world hello_world.c

# 运行，由于没有添加到 PATH，所以要加 ./
./hello_world
```

>[!hint] 当我们在别的目录中，再想运行那两个程序时，会发现提示命令找不到【~~除非加上命令的完整路径~~】，这时，我们可以将命令所在路径添加到 `PATH`，我们就可以像使用系统命令一样执行自己创建的脚本文件或者程序了

## 添加到 PATH
1. `PATH=$PATH:/home/shiyanlou/mybin` ：`PATH` 里面的路径是以 `:` 作为分割符的

>[!warning] 这里一定要使用绝对路径

---

2. 添加内容到配置脚本中
```bash
echo "PATH=$PATH:/home/shiyanlou/mybin" >> .zshrc
```

>[!hint] 在每个用户的 home 目录中有一个 Shell 每次启动时会默认执行一个配置脚本【初始化环境，添加一些用户自定义环境变量……】
> - 如果 Shell 是 zsh，那配置文件就是 `.zshrc`
> - 如果是 Bash，则配置文件为 `.bashrc`

>[!hint] Shell 的种类有很多，可以使用 `cat /etc/shells` 查看当前系统已安装的 Shell

---

现在就可以在任意目录执行命令了

## 删除/修改 PATH

|变量设置方式|说明|
|---|---|
|`${变量名#匹配字串}`|从头向后开始匹配，删除符合匹配字串的最短数据|
|`${变量名##匹配字串}`|从头向后开始匹配，删除符合匹配字串的最长数据|
|`${变量名%匹配字串}`|从尾向前开始匹配，删除符合匹配字串的最短数据|
|`${变量名%%匹配字串}`|从尾向前开始匹配，删除符合匹配字串的最长数据|
|`${变量名/旧的字串/新的字串}`|将符合旧字串的第一个字串替换为新的字串|
|`${变量名//旧的字串/新的字串}`|将符合旧字串的全部字串替换为新的字串|

比如我们可以修改前面添加到 PATH 的环境变量，将添加的 mybin 目录从环境变量里删除。为了避免操作失误导致命令找不到，我们先将 PATH 赋值给一个新的自定义变量 mypath：

```bash
mypath=$PATH
echo $mypath
mypath=${mypath%/home/shiyanlou/mybin}
# 或使用通配符 * 表示任意多个任意字符
mypath=${mypath%*/mybin}
```

可以看到路径已经不存在了。

![图片描述](https://doc.shiyanlou.com/courses/uid871732-20200303-1583224278229)

#### 变量删除

可以使用 `unset` 命令删除一个环境变量：

```bash
unset mypath
```

![图片描述](https://doc.shiyanlou.com/courses/uid871732-20200303-1583224422523)

































